<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="description" content="Project page for research on adaptive shielding for runtime safety in reinforcement learning with hidden parameter inference and provable guarantees.">
  <meta property="og:title" content="Runtime Safety through Adaptive Shielding: From Hidden Parameter Inference to Provable Guarantees"/>
  <meta property="og:description" content="Ensuring safety for RL agents with unknown hidden parameters using adaptive shielding, function encoders, and conformal prediction."/>
  <meta property="og:url" content="https://kmj1122.github.io/adaptive-shielding-project-page/"/> <meta property="og:image" content="static/images/flowchart2.png" /> <meta property="og:image:width" content="1200"/>
  <meta property="og:image:height" content="630"/>

  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="Runtime Safety through Adaptive Shielding: From Hidden Parameter Inference to Provable Guarantees">
  <meta name="twitter:description" content="Ensuring safety for RL agents with unknown hidden parameters using adaptive shielding, function encoders, and conformal prediction.">
  <meta name="twitter:image" content="static/images/flowchart2.png"> <meta name="keywords" content="Runtime Safety, Adaptive Shielding, Reinforcement Learning, Hidden Parameters, Provable Guarantees, Conformal Prediction, Robotics">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>Runtime Safety through Adaptive Shielding: From Hidden Parameter Inference to Provable Guarantees</title>
  <link rel="icon" type="image/x-icon" href="static/images/favicon.ico">
  <link href="https://fonts.googleapis.com/css?family=Google+Sans|Noto+Sans|Castoro"
  rel="stylesheet">

  <link rel="stylesheet" href="static/css/bulma.min.css">
  <link rel="stylesheet" href="static/css/bulma-carousel.min.css">
  <link rel="stylesheet" href="static/css/bulma-slider.min.css">
  <link rel="stylesheet" href="static/css/fontawesome.all.min.css">
  <link rel="stylesheet"
  href="https://cdn.jsdelivr.net/gh/jpswalsh/academicons@1/css/academicons.min.css">
  <link rel="stylesheet" href="static/css/index.css"> <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script src="https://documentcloud.adobe.com/view-sdk/main.js"></script>
  <script defer src="static/js/fontawesome.all.min.js"></script>
  <script src="static/js/bulma-carousel.min.js"></script>
  <script src="static/js/bulma-slider.min.js"></script>
  <script src="static/js/index.js"></script>
</head>
<body>

  <section class="hero">
    <div class="hero-body">
      <div class="container is-max-desktop">
        <div class="columns is-centered">
          <div class="column has-text-centered">
            <h1 class="title is-1 publication-title">Runtime Safety through Adaptive Shielding: From Hidden Parameter Inference to Provable Guarantees</h1>
            <div class="is-size-5 publication-authors">
              <span class="author-block">
                <a href="https://github.com/kmj1122" target="_blank">Minjae Kwon</a><sup>1</sup>,
              </span>
              <span class="author-block">
                <a href="https://tyler-ingebrand.github.io/" target="_blank">Tyler Ingebrand</a><sup>2</sup>,
              </span>
              <span class="author-block">
                <a href="https://www.ae.utexas.edu/people/faculty/faculty-directory/topcu" target="_blank">Ufuk Topcu</a><sup>2</sup>,
              </span>
              <span class="author-block">
                <a href="https://www.cs.virginia.edu/~lufeng/" target="_blank">Lu Feng</a><sup>1</sup>
              </span>
            </div>

            <div class="is-size-5 publication-authors">
              <span class="author-block"><sup>1</sup>The University of Virginia,</span>
              <span class="author-block"><sup>2</sup>The University of Texas at Austin</span>
              <br>
              <!-- <span class="author-block">Submitted to 39th Conference on Neural Information Processing Systems (NeurIPS 2025). Do not distribute.</span> -->
              </div>

            <div class="column has-text-centered">
              <div class="publication-links">
                <!-- <span class="link-block">
                  <a href="[LINK_TO_YOUR_PAPER_PDF_ON_ARXIV_OR_ELSEWHERE]" target="_blank"
                  class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                    <i class="fas fa-file-pdf"></i>
                  </span>
                  <span>Paper</span>
                </a>
                </span> -->

                <span class="link-block">
                  <a href="static/pdf/Adaptive_Shield.pdf" target="_blank"
                  class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                    <i class="fas fa-file-pdf"></i>
                  </span>
                  <span>Paper</span>
                </a>
                </span>

                <span class="link-block">
                  <a href="https://github.com/safe-autonomy-lab/AdaptiveShieldingFE" target="_blank"
                  class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                    <i class="fab fa-github"></i> </span>
                  <span>Code</span>
                </a>
                </span>

                <!-- <span class="link-block">
                  <a href="[LINK_TO_ARXIV_ABSTRACT_IF_AVAILABLE]" target="_blank"
                  class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                    <i class="ai ai-arxiv"></i>
                  </span>
                  <span>arXiv</span>
                </a>
                </span> -->
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>

  <section class="hero teaser">
    <div class="container is-max-desktop">
      <div class="hero-body">
        <img src="static/images/flowchart2.png" alt="Flowchart of our Adaptive Shielding Approach" style="width:100%; max-width:800px; display:block; margin-left:auto; margin-right:auto;">
        <h2 class="subtitle has-text-centered" style="margin-top:1rem;">
          Our adaptive shielding framework integrates real-time hidden parameter inference with uncertainty-aware action filtering. Ensuring robots operate safely despite unknown variations in their physical properties (like mass or friction) is a major challenge.
        </h2>
      </div>
    </div>
  </section>
  <section class="section hero is-light" id="abstract"> <div class="container is-max-desktop">
      <div class="columns is-centered has-text-centered">
        <div class="column is-four-fifths">
          <h2 class="title is-3">Abstract</h2>
          <div class="content has-text-justified">
            <p>
              Variations in hidden parameters, such as a robot's mass distribution or friction, pose safety risks during execution. We develop a runtime shielding mechanism for reinforcement learning, building on the formalism of constrained hidden-parameter Markov decision processes. Function encoders enable real-time inference of hidden parameters from observations, allowing the shield and the underlying policy to adapt online. The shield constrains the action space by forecasting future safety risks (such as obstacle proximity) and accounts for uncertainty via conformal prediction. We prove that the proposed mechanism satisfies probabilistic safety guarantees and yields optimal policies among the set of safety-compliant policies. Experiments across diverse environments with varying hidden parameters show that our method significantly reduces safety violations and achieves strong out-of-distribution generalization, while incurring minimal runtime overhead.
            </p>
          </div>
        </div>
      </div>
    </div>
  </section>
  <section class="section" id="approach"> <div class="container is-max-desktop">
          <div class="columns is-centered">
              <div class="column is-four-fifths">
                  <h2 class="title is-3 has-text-centered">The Challenge: Safety with Unknown Dynamics</h2>
                  <div class="content has-text-justified">
                      <p>
                          Robots and autonomous systems in open-world environments often encounter varying underlying dynamics due to unobserved hidden parameters (mass, friction, terrain). These variations pose significant safety risks and challenge the generalization of reinforcement learning (RL) systems. Current methods often trade off adaptability for safety, or vice-versa, especially when dynamics change online.
                      </p>
                  </div>
                  <br>
                  <h2 class="title is-3 has-text-centered">Our Approach: Adaptive Shielding with Safety Regularization</h2>
                  <div class="content">
                      <p>We propose a runtime shielding framework that adapts online to hidden parameters while offering provable probabilistic safety. The core components are:</p>
                      <ol>
                          <li><strong>Online Hidden-Parameter Adaptation:</strong> We leverage function encoders to efficiently infer hidden parameters from recent observations, enabling both the policy and the shield to adapt without retraining.</li>
                          <li><strong>Safety-Regularized RL Objective (SRO):</strong> A novel objective function that balances reward maximization with safety by integrating a cost-sensitive value estimate, encouraging low-violation behavior during training. Refer to Appendix G to see why this design choice is important.
                            <div class="columns is-vcentered is-mobile is-centered" style="margin-top: 0.5rem; margin-bottom: 0.5rem;">
                                <div class="column is-two-fifths">
                                    <img src="static/images/Q_aug.png" alt="Q-augmented safety objective" style="width:100%; display:block; margin-left:auto; margin-right:auto; margin-bottom:0;">
                                </div>
                                <div class="column is-narrow has-text-centered">
                                    <p style="margin: 0 0.5rem;"><em>where</em></p>
                                </div>
                                <div class="column is-two-fifths">
                                    <img src="static/images/Q_safe.png" alt="Q-safe objective" style="width:100%; display:block; margin-left:auto; margin-right:auto; margin-bottom:0;">
                                </div>
                            </div>
                         </li> 
                          
                            
                          <li><strong>Adaptive Shield:</strong> A runtime shield that filters potentially unsafe actions proposed by the policy. It uses the inferred dynamics and conformal prediction to quantify uncertainty in future state forecasts, ensuring actions comply with safety margins.</li>
                      </ol>
                      <p>This combination allows for robust safety and performance even when the robot's dynamics change unexpectedly.</p>
                  </div>
              </div>
          </div>
      </div>
  </section>

  <section class="hero is-small" id="results"> <div class="hero-body">
    <div class="container">
      <h2 class="title is-3 has-text-centered">Theoretical Results</h2>
      <p class="has-text-centered">
        <ol>
            <li><strong>Proposition: Optimality Preservation:</strong> SRO effectively guides policy learning toward safe behaviors while not unnecessarily degrading performance when the agent already behaves safely.</li>
            <li><strong>Theorem: Provable Safety and Performance:</strong> An optimal policy, when augmented with our adaptive shield, maximizes the expected cumulative discounted return while maintaining a tight bound on the average cost rate. This provides a formal guarantee that our framework not only achieves high performance in terms of task completion but also adheres to provable safety guarantees.</li>
        </ol>
    </p>
      <br>
      <div id="results-carousel" class="carousel results-carousel">
        <div class="item">
          <img src="static/images/Proposition.png" alt="Proposition on optimal policy"/>
        </div>
        <div class="item">
          <img src="static/images/Theorem1.png" alt="Theorem 1"/>
        </div>

        </div>
        </div>
    </div>
  </div>
</section>


  <section class="hero is-small" id="results"> <div class="hero-body">
      <div class="container">
        <h2 class="title is-3 has-text-centered">Empirical Results</h2>
        <p class="has-text-centered">Our method demonstrates significant improvements in safety and generalization compared to established baselines across various Safe-Gym benchmarks.</p>
        <br>
        <div id="results-carousel" class="carousel results-carousel">
          <div class="item">
            <img src="static/images/rq1_car.png" alt="Training curves for safety and return - Car robot"/>
            <h2 class="subtitle has-text-centered">
              RQ1: Balancing Safety and Task Performance (Car Robot)
            </h2>
          </div>
          <div class="item">
            <img src="static/images/rq1_point.png" alt="Training curves for safety and return - Point robot"/>
            <h2 class="subtitle has-text-centered">
              RQ1: Balancing Safety and Task Performance (Point Robot)
            </h2>
          </div>
          <div class="item">
            <img src="static/images/rq2_level2.png" alt="OOD Generalization: Return vs. Cost Rate"/>
            <h2 class="subtitle has-text-centered">
              RQ2: Generalization to Out-of-Distribution Environments
            </h2>
          </div>
          </div>
        <div class="content has-text-centered" style="margin-top: 20px;">
            <h3 class="title is-4">RQ3: Execution-Time Efficiency</h3>
            <div class="item">
                <img src="static/images/Table.png" alt="The runtime speed of our method compared to the baselines"/>
            </div>
            <p>Our approach introduces only modest runtime overhead compared to baselines, with the shield being triggered selectively. This makes it suitable for real-time deployment. (Refer to Table 1 in the paper for detailed metrics).</p>
            <p style="margin-top: 10px;">Further ablation studies and detailed results can be found in the main paper and appendix.</p>
        </div>
      </div>
    </div>
  </section>
  <!-- <section class="hero is-small is-light">
    <div class="hero-body">
      <div class="container">
        <h2 class="title is-3">Video Presentation (Optional)</h2>
        <div class="columns is-centered has-text-centered">
          <div class="column is-four-fifths">
            <div class="publication-video">
              <p><em>If you have a video presentation, embed it here. Example:</em></p>
              <iframe src="https://www.youtube.com/embed/dQw4w9WgXcQ" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe>
            </div>
          </div>
        </div>
      </div>
    </div>
  </section> -->
  <!-- <section class="section" id="citation"> <div class="container is-max-desktop content">
      <h2 class="title">BibTeX</h2>
      <pre><code>@article{Kwon2025ASHIELD,
    title   = {Runtime Safety through Adaptive Shielding: From Hidden Parameter Inference to Provable Guarantees},
    author  = {Minjae Kwon and Tyler Ingebrand and Ufuk Topcu and Lu Feng},
    journal = {arXiv preprint arXiv:XXXX.XXXXX}, <!- UPDATE THIS ->
    year    = {2025} % TODO: Add conference details if/when accepted, e.g., booktitle, publisher, pages etc.
}</code></pre>
    </div>
  </section> -->
  <footer class="footer">
    <div class="container">
      <div class="columns is-centered">
        <div class="column is-8">
          <div class="content">
            <p>
              Contact: Minjae Kwon (hbt9su@virginia.edu)
            </p>
            <p>
              This page was built using the <a href="https://github.com/eliahuhorwitz/Academic-project-page-template" target="_blank">Academic Project Page Template</a> which was adopted from the&nbsp;<a href="https://nerfies.github.io" target="_blank">Nerfies</a>&nbsp;project page.
              You are free to borrow the source code of this website, we just ask that you link back to this page in the footer. <br> This website is licensed under a <a rel="license"  href="http://creativecommons.org/licenses/by-sa/4.0/" target="_blank">Creative
              Commons Attribution-ShareAlike 4.0 International License</a>.
            </p>
            <p>
                Last updated: May 20, 2025. </p>
          </div>
        </div>
      </div>
    </div>
  </footer>

  </body>
</html>